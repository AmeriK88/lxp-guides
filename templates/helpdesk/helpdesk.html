{% extends "layouts/base.html" %}
{% block title %}Centro de Ayuda - LanzaXperience{% endblock %}

{% block content %}
<div class="max-w-4xl mx-auto px-4 py-10">

  <div class="card">
    <div class="card-body">
      <div class="flex flex-wrap items-center gap-2">
        <span class="badge">üìö Centro de ayuda</span>

        {% if q %}
          <a href="{% url 'helpdesk:helpdesk' %}" class="badge hover-lift">
            ‚Üê Volver
          </a>
        {% endif %}
      </div>

      <h1 class="h1-hero">Centro de Ayuda</h1>
      <p class="mt-2 p-muted">
        Encuentra respuestas claras. Si no lo ves aqu√≠, cont√°ctanos.
      </p>

      <div class="mt-6 contact-box">
        <p class="p-body">
          Email: <strong>support@lanzaxperience.com</strong>
        </p>
        <a href="mailto:support@lanzaxperience.com" class="btn btn-primary">
          Contactar
        </a>
      </div>

      {# (Opcional) Buscador en siguiente paso #}
      <div class="mt-6">
        {% include "components/search_card.html" %}
      </div>
      {% if q and not categories %}
        <div class="alert alert-warn mt-4">
          <p class="p-body">
            No encontr√© resultados para <strong>‚Äú{{ q }}‚Äù</strong>.
            Prueba con otra palabra como ‚Äúcancelaci√≥n‚Äù, ‚Äúcambio‚Äù o ‚Äúreembolso‚Äù.
          </p>
        </div>
      {% endif %}

    </div>
  </div>

  <div class="mt-6 space-y-4">
    {% for category in categories %}
      <section class="card">
        <div class="card-body">
          <div class="flex items-start justify-between gap-4">
            <div>
              <h2 class="h2-section">{{ category.name }}</h2>
              {% if category.description %}
                <p class="mt-1 p-muted">{{ category.description }}</p>
              {% endif %}
            </div>
            <span class="badge">
              {{ category.filtered_articles|length }} art√≠culos
            </span>
          </div>

          <div class="mt-4">
            <ul class="space-y-3">
              {% for article in category.filtered_articles %}
                {% if article.is_published %}
                  <li class="doc-item">
                    <div class="min-w-0">
                      <a href="{% url 'helpdesk:article_detail' article.slug %}"
                         class="p-secondary hover:text-slate-900 transition clamp-1">
                        {{ article.title }}
                      </a>
                      <p class="p-micro mt-1">
                        {{ article.category.name }}
                        {% if article.is_featured %}
                          <span class="badge badge-blue ml-2">Destacado</span>
                        {% endif %}
                      </p>
                    </div>

                    <span class="badge">‚Üí</span>
                  </li>
                {% endif %}
              {% empty %}
                <li class="p-muted">No se encontraron art√≠culos para esta b√∫squeda.</li>
              {% endfor %}
            </ul>
          </div>
        </div>
      </section>
    {% endfor %}
  </div>

</div>
{% endblock %}
